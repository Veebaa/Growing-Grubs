<!DOCTYPE html>
<html lang="en">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <title>Growing Grubs</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('other_routes.static', filename='css/homepage/main.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('other_routes.static', filename='css/homepage/header.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('other_routes.static', filename='css/homepage/main-content.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('other_routes.static', filename='css/homepage/right-sidebar.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('other_routes.static', filename='css/homepage/footer.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('other_routes.static', filename='css/homepage/navbar.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <script>
        async function fetchPopularRecipe() {
            const apiKey = 'c676336b8de04c04b131f2f91eb14b33';
            const response = await fetch(`https://api.spoonacular.com/recipes/random?number=1&apiKey=${apiKey}`);

            if (!response.ok) {
                console.error("Failed to fetch popular recipe:", response.statusText);
                return; // Early return if the fetch fails
            }

            const data = await response.json();
            console.log("Popular recipe data fetched:", data);

            // Update the HTML with the fetched recipe
            const recipe = data.recipes[0];
            if (!recipe) {
                console.error("No recipe found in response");
                return; // Early return if no recipe is found
            }

            document.getElementById('toprecipe_image').src = recipe.image;
            document.getElementById('toprecipe_title').innerText = recipe.title;
            document.getElementById('toprecipe_link').href = `/meal/${recipe.id}`;
        }

        function showPopup(message) {
            const popup = document.getElementById('popup');
            const overlay = document.getElementById('overlay');
            popup.innerText = message;
            popup.classList.add('show');
            overlay.classList.add('show');

            setTimeout(() => {
                popup.classList.remove('show');
                overlay.classList.remove('show');
            }, 3000); // Auto-hide after 3 seconds
        }

        // Call the function when the page loads
        window.onload = function() {
            fetchPopularRecipe();
            const messages = {{ get_flashed_messages()|tojson }};
            if (messages.length > 0) {
                showPopup(messages[0]); // Show the first message
            }
        };

         async function fetchTopics() {
      try {
        const response = await fetch('/topics');
        if (!response.ok) throw new Error('Failed to fetch topics');
        const data = await response.json();

        let sidebarContent = '';
        data.forEach(topic => {
          sidebarContent += `<li><a href="${topic.url}">${topic.title}</a></li>`;
        });

        document.getElementById('sidebar').innerHTML = `<ul>${sidebarContent}</ul>`;
      } catch (error) {
        console.error('Error fetching topics:', error);
        document.getElementById('sidebar').innerHTML = '<p>Error loading topics. Please try again later.</p>';
      }
    };
    </script>

</head>

<body class="homepage">
    <header class="header">
        <img class="header-image" src="static/images/growinggrubs_header_3.jpeg" alt="header-image">
    </header>

    <nav class="navbar">
        <a href="{{ url_for('other_routes.index') }}">Home</a>
         <div class="navbar_dropdown">
            <button class="dropdown">Recipes
            <i class="fa fa-caret-down"></i>
            </button>
            <div class="dropdown_content">
               <a href="{{ url_for('other_routes.recipes') }}">All Recipes</a>
               <a href="{{ url_for('other_routes.recipes1') }}">6 - 9 Months</a>
                <a href="{{ url_for('other_routes.recipes2') }}">9 - 12 Months</a>
                <a href="{{ url_for('other_routes.recipes2') }}">1 - 4 Years</a>
            </div>
        </div>
        <div class="navbar_dropdown">
            <button class="dropdown">Feeding Tips
            <i class="fa fa-caret-down"></i>
            </button>
            <div class="dropdown_content">
               <a href="{{ url_for('other_routes.signs') }}">Signs that your baby is ready</a>
               <a href="{{ url_for('other_routes.feeding_stages') }}">Feeding Stages</a>
            </div>
        </div>
        <a href="{{ url_for('other_routes.healthy_eating') }}">Healthy Eating</a>
        <a href="{{ url_for('other_routes.login') }}">Login</a>
        <a href="{{ url_for('other_routes.register_user') }}">Register</a>
        <div class="search-container">
            <form action="{{ url_for('other_routes.search') }}" method="post">
                <input type="text" placeholder="Search recipes.." name="search" required>
                <button type="submit"><i class="fa fa-search"></i></button>
            </form>
        </div>
    </nav>

    <div class="container">
        <main class="container__main-content">
            <h1>About Us</h1>
            <p>As a mother who has experienced the challenges of providing nourishing meals for children
                during the weaning stage, I understand the overwhelming and conflicting information that
                parents often face. That's why I am excited to introduce our web application, designed to
                support parents of children aged 6 months to 4 years old. Our mission is to provide a
                comprehensive guide on weaning, healthy eating habits, and a variety of nutritious recipes
                perfect for young kids. We understand that parents are busy, which is why our app features
                quick and easy recipes, tips for introducing a range of foods, and promotes healthy eating
                habits from an early age. Our user-friendly platform aims to empower parents to confidently
                nourish their children and cultivate a positive relationship with food. Join us on this
                journey towards healthier and happier mealtimes for your little ones.</p>
            <br>
            <div class="container__main-content__top recipes">
                <h1>Today's Top Recipe</h1>
                <div class="main-content__top recipes">
                    <img id="toprecipe_image" class="toprecipe_image" src="" alt="recipe image">
                    <h1 id="toprecipe_title"></h1>
                    <a id="toprecipe_link" href="" target="_blank">View Recipe</a> <!-- Link to the recipe -->
                </div>
            </div>
        </main>
        <aside class="container__right-sidebar" id="sidebar">
            <h1>Today's Top Stories</h1>
        </aside>
    </div>

    <footer class="footer">
       <p class="footer_text">&#169 Copyright Growing Grubs - Created 2024</p>
    </footer>

<div id="overlay" class="overlay"></div>
<div id="popup" class="popup"></div>

</body>

</html>

